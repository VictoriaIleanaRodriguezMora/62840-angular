<!-- si terminó de cargar, pero hay un error -->
<p *ngIf="isLoading; else contentTemplate">Por favor espere...</p>
<ng-template #contentTemplate>
  <p *ngIf="promiseHasError; else successTemplate">Ocurrió un error.</p>

  <ng-template #successTemplate>
    <h1
      *appMultiply="5"
      (colorUpdated)="onColorUpdated()"
      [bolder]="true"
      appHighlight="green"
    >
      Estudiantes
    </h1>
    <form [formGroup]="studentForm" (ngSubmit)="onSubmit()">
      <div class="grid">
        <div class="col-6">
          <mat-form-field appearance="fill">
            <mat-label>Nombre</mat-label>
            <input matInput formControlName="name" appearance="outline" />
          </mat-form-field>
        </div>
        <div class="col-6">
          <mat-form-field appearance="fill">
            <mat-label>Apellido</mat-label>
            <input matInput formControlName="lastName" appearance="outline" />
          </mat-form-field>
        </div>
      </div>

      <button mat-flat-button type="submit">Guardar</button>
    </form>

    <!-- TABLAS - INICIO -->
    <!-- data Source hace referencia a los elementos que yo quiero mostrar. Entonces el "dataSource" va a ser mi array de estudiantes  -->
    <table mat-table [dataSource]="students" class="mat-elevation-z8">
      <!-- id Column -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>Id</th>
        <!-- la variable "element" es un elemento del arreglo students. Students es mi array, de objetos de estudiantes. Le puedo poner el nombre que yo quiera  -->
        <td mat-cell *matCellDef="let element">{{ element.id }}</td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <!-- value del pipe seria element.name -->
        <!--  despues del nombre del pipe: argumento -->
        <!-- <td mat-cell *matCellDef="let element">{{ element.name | fullName: "uppercase"}}</td> -->
        <!-- <td mat-cell *matCellDef="let element"> {{ element.name | fullName : "uppercase" }} </td> -->
        <!-- Escucho el evento colorUpdated, y ejecuto la funcion:  cuando ocurra -->
        <td
          (colorUpdated)="onColorUpdated()"
          appHighlight
          mat-cell
          *matCellDef="let element"
        >
          {{ element | fullName2 }}
        </td>
      </ng-container>

      <!-- lastName Column -->
      <ng-container matColumnDef="lastName">
        <th mat-header-cell *matHeaderCellDef>lastName</th>
        <td mat-cell *matCellDef="let element">{{ element.lastName }}</td>
      </ng-container>

      <!-- action Column -->
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>action</th>
        <td mat-cell *matCellDef="let element">
          <button (click)="onDelete(element.id)" mat-button>
            <mat-icon>delete</mat-icon>
          </button>
          <!-- envia el array del estudiante {id, name, lastName} -->
          <button (click)="onEdit(element)" mat-button>
            <mat-icon>edit</mat-icon>
          </button>
          <!-- boton para ver -->
          <button (click)="getStudentDetails(element.id)" mat-button>
            <mat-icon>visibility</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <!-- TABLAS - FIN -->
    <!-- <button mat-stroked-button>Crear estudiante</button>
<button>
  <mat-icon mat-icon-button>delete</mat-icon>
</button> -->
    <!-- seria mejor mostrarlo en una tabla -->
    <!-- <pre> {{ students | json }} </pre> -->

    <div *ngIf="selectedStudent" class="mat-elevation-z4 p-4 m-2">
      <h2>Detalles del estudiante</h2>
      <p>ID: {{ selectedStudent.id }}</p>
      <p>name: {{ selectedStudent.name }}</p>
      <p>lastName: {{ selectedStudent.lastName }}</p>
    </div>

    <br />
    <br />
    <br />
    <br />
    <br />
  </ng-template>
</ng-template>
